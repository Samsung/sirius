<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/></head><body><h1 id="Distributeshapesactionsindiagram">Distribute shapes actions in diagram</h1><h2 id="Preamble">Preamble</h2><p><em>Summary</em>: Add distribute shapes actions in diagram</p><table><tr><th>Version </th><th>Status </th><th>Date        </th><th>Authors </th><th>Changes </th></tr><tr><td>v0.2        </td><td>DRAFT    </td><td>2014-09-08 </td><td>lredor    </td><td>Initial version. </td></tr><tr><td>v0.3        </td><td>PROPOSAL    </td><td>2014-09-10 </td><td>lredor    </td><td>Team review. </td></tr></table><p><em>Relevant tickets</em> :</p><ul><li><a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=442289">442289, Distribute shapes</a></li></ul><h2 id="Introduction">Introduction</h2><p>Distribute actions are often available in graphical/drawing soft (<a href="https://help.libreoffice.org/Common/Distribution">LibreOffice</a> , <a href="http://en.flossmanuals.net/inkscape/positioning-objects/align-and-distribute">Inskape</a> , <a href="http://office.microsoft.com/en-gb/visio-help/distribute-shapes-HP001231368.aspx">Visio</a> , ...). This kind of actions is very useful and misses in Sirius.<br/>The goal of this feature is to remedy this problem.</p><p>4 new actions allowing to distribute shapes will be added:</p><ul><li><ul><li>Distribute centers evenly horizontally <img border="0" src="images/distributeCentersHorizontal.png"/></li><li>Distribute with uniform gaps horizontally <img border="0" src="images/distributeWithUniformGapHorizontal.png"/></li><li>Distribute centers evenly vertically <img border="0" src="images/distributeCentersVertical.png"/></li><li>Distribute with uniform gaps vertically <img border="0" src="images/distributeWithUniformGapVertical.png"/></li></ul></li></ul><h2 id="DetailedSpecification">Detailed Specification</h2><p>These actions will be available in the tabbar in a drop down menu similar to and located after the <em>Align</em> actions menu. The default action of this drop down menu will be <em>Distribute Horizontally With Uniform Gaps</em>.<br/>They will also be in the <em>Diagram</em> menu from the Eclipse menu bar and in the contextual <em>Format</em> menu when diagram elements are selected.<br/>They will be enabled only for selected nodes with same direct parent. At least 3 shapes should be selected to enable distribute actions.<br/>For border nodes, they will be enabled only if all selected border nodes have the same parent and are on the same axis (top and bottom sides for horizontal actions, left and right for vertical actions). The overlap is forbidden for border nodes, so in some conditions (location already used), these actions may not have accurate results.</p><p>For all actions, the first and the last shapes do not move.</p><h3 id="Firstandlastshapes">First and last shapes</h3><p>The first and last shapes do not depend on the selection order. They depend on the location of each selected shapes and the chosen action.</p><p>For horizontal distribution with uniform gaps:</p><ul><li>the first shape is the leftmost one (with the minimum x location). If several shapes have the same x location, the highest one is the first.</li><li>the last shape is the rightmost one (with the right side with the maximum x coordinate). If several shapes are aligned to the right, the lowest one is the last.</li></ul><p>For horizontal centered distribution:</p><ul><li>the first shape is the leftmost one (with its center at the minimum x coordinate). If several shapes are aligned on center, the one with the highest center is the first.</li><li>the last shape is the rightmost one (with its center at the maximum x coordinate). If several shapes are aligned by center, the one with the lowest center is the last.</li></ul><p>For vertical distribution with uniform gaps:</p><ul><li>the first shape is the highest one (with the minimum y location). If several shapes have the same y location, the leftmost one is the first.</li><li>the last shape is the lowest one (with the bottom side with the maximum y coordinate). If several shapes are aligned to the bottom, the rightmost one is the last.</li></ul><p>For vertical centered distribution:</p><ul><li>the first shape is the highest one (with its center at the minimum y coordinate). If several shapes are aligned on middle, the leftmost one is the first.</li><li>the last shape is the lowest one (with the bottom side with the maximum y coordinate). If several shapes are aligned by middle, the rightmost one is the last.</li></ul><p>Information: When speaking above of the right or the bottom side, the border nodes of a shape are ignored.</p><h3 id="Distributecentersevenly">Distribute centers evenly</h3><p>With this action, the gap between centers of each selected shapes will be the same.</p><p>Initial state<br/><img border="0" src="images/initialState.png"/></p><p>Result after having launched the <em>distribute centers evenly horizontally</em> action<br/><img border="0" src="images/distributeCenters.png"/></p><h3 id="Distributewithuniformgaps">Distribute with uniform gaps</h3><p>With this action, the gap between the left side and the right side of each consecutive shapes will be the same.</p><p>Result after having launched the <em>distribute with uniform gaps horizontally</em> action (from the same initial state)<br/><img border="0" src="images/distributeWithUniformGap.png"/></p><h3 id="Overlap">Overlap</h3><p>Overlap could happen, or in other words, the gap can be negative.</p><p>Initial state<br/><img border="0" src="images/initialState2.png"/></p><p>Result after after having launched the <em>distribute with uniform gaps horizontally</em> action<br/><img border="0" src="images/distributeWithUniformGap2.png"/></p><h3 id="Sequencediagram">Sequence diagram</h3><p>These actions are not enabled on sequence diagrams. The layout, and hence the gaps between objects, are conditioned by the model itself.</p><h3 id="Pinstatus">Pin status</h3><p>If the preference <em>Sirius/Sirius Diagram/Automatically mark moved elements as pinned</em> is checked, these actions have no effect on pin status (as for existing align actions).</p><h2 id="BackwardCompatibilityandMigrationPaths">Backward Compatibility and Migration Paths</h2><h3 id="MetamodelChanges">Metamodel Changes</h3><p>No metammodel changes.</p><h3 id="APIChanges">API Changes</h3><p>There will be no change in existing API.</p><h3 id="UserInterfaceChanges">User Interface Changes</h3><p>A new drop down menu will be added to the diagram editor toolbar.<br/>The <em>Diagram</em> menu from Eclipse menu bar and the contextual <em>Format</em> menu will be completed with the new actions.</p><h3 id="DocumentationChanges">Documentation Changes</h3><p>Diagram editor documentation will be updated to describe these new actions.</p><h2 id="TestsandNonregressionstrategy">Tests and Non-regression strategy</h2><p>At least one test for each added action.<br/>At least one of them with zoom and scroll-bar.<br/>One test with negative gap.<br/>One test with 2 shapes at same axis (top, bottom, middle, left, right, center according to action launched) to check first and last shape computing<br/>Several tests for disablement checking: 2 shapes selected, several shapes not at same level, border nodes not on same side.</p><h2 id="Implementationchoicesandtradeoffs">Implementation choices and tradeoffs</h2><p>These actions could be contributed to GMF through <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=290898">https://bugs.eclipse.org/bugs/show_bug.cgi?id=290898</a></p></body></html>